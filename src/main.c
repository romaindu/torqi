/*
 * main.c
 *
 * @author: Romain Durand
*/

#include "setup.h"

#include "mot/controller.h"

const int16_t lut[128] = {2048,2072,2097,2121,2146,2170,2194,2217,2240,2263,2285,2306,2327,2347,2367,2385,2403,2420,2436,2451,2465,2478,2490,2501,2511,2520,2527,2534,2539,2543,2546,2547,2547,2547,2544,2541,2536,2531,2524,2516,2506,2496,2485,2472,2458,2444,2428,2412,2394,2376,2357,2337,2317,2296,2274,2252,2229,2206,2182,2158,2134,2109,2085,2060,2035,2010,1986,1961,1937,1913,1889,1866,1843,1821,1799,1778,1758,1738,1719,1701,1683,1667,1651,1637,1623,1610,1599,1589,1579,1571,1564,1559,1554,1551,1548,1548,1548,1549,1552,1556,1561,1568,1575,1584,1594,1605,1617,1630,1644,1659,1675,1692,1710,1728,1748,1768,1789,1810,1832,1855,1878,1901,1925,1949,1974,1998,2023,2047};

extern int32_t ipha, iphb;

int main(void)
{
    setup_clocks();
    setup_init();
    setup_ports();

    puts("\n\n=============== DEBUG ENABLED ===============\n");

    motor_enable();

    uint8_t i = 0;
    uint8_t j = 32;

    for (;;) {
        ipha = lut[i];
        iphb = lut[j];
        i++;
        j++;
        if (i >= 128) i = 0;
        if (j >= 128) j = 0;
        for (int e = 0; e < 0xff; ++e) {}
    }

    return 0;
}
